<Window x:Class="KingdomHeartsCustomMusic.utils.ProgressWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Generating Patch - Kingdom Hearts Custom Music" 
        Height="350" Width="600"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        WindowStyle="ToolWindow"
        Topmost="True"
        Closing="Window_Closing">
    
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisConverter"/>
    </Window.Resources>
    
    <Border Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" 
            Padding="20">
        <StackPanel>
            <!-- Header -->
            <Border Background="DarkBlue" Padding="15,10" Margin="0,0,0,20" CornerRadius="5">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="??" FontSize="24" Margin="0,0,10,0" VerticalAlignment="Center"/>
                    <TextBlock Text="Kingdom Hearts Custom Music Patcher"
                               Foreground="White" FontWeight="Bold" FontSize="16"
                               VerticalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Track Progress Section (Only visible during patch generation) -->
            <Border Background="LightGray" Padding="10" Margin="0,0,0,15" CornerRadius="5"
                    Visibility="{Binding ShowTrackProgress, Converter={StaticResource BoolToVisConverter}}">
                <StackPanel>
                    <TextBlock Text="{Binding TrackProgressText}" 
                               FontWeight="Bold" FontSize="12"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,8"/>
                    
                    <ProgressBar Height="20" 
                                 Value="{Binding TrackProgressValue}" 
                                 Maximum="100"
                                 Margin="0,0,0,5"/>
                    
                    <TextBlock Text="{Binding CurrentTrackText}" 
                               FontSize="11" FontStyle="Italic"
                               HorizontalAlignment="Center"
                               Foreground="DarkSlateGray"/>
                </StackPanel>
            </Border>

            <!-- Main Progress Text -->
            <TextBlock Text="{Binding ProgressText}" 
                       FontSize="14" FontWeight="Bold" 
                       Margin="0,0,0,10"
                       TextWrapping="Wrap"/>

            <!-- Progress Bar -->
            <ProgressBar Height="25" 
                         Value="{Binding ProgressValue}" 
                         Maximum="100"
                         IsIndeterminate="{Binding IsIndeterminate}"
                         Margin="0,0,0,15"/>

            <!-- Progress Percentage -->
            <TextBlock Text="{Binding ProgressValue, StringFormat={}{0:F1}%}" 
                       HorizontalAlignment="Center"
                       FontWeight="Bold"
                       Margin="0,0,0,10"/>

            <!-- Detail Text -->
            <ScrollViewer Height="80" VerticalScrollBarVisibility="Auto" 
                          BorderBrush="Gray" BorderThickness="1"
                          Background="White" Padding="5">
                <TextBlock Text="{Binding DetailText}" 
                           FontSize="11" FontFamily="Consolas"
                           TextWrapping="Wrap"/>
            </ScrollViewer>

            <!-- Info Text -->
            <TextBlock Text="Please do not close this window during patch operation"
                       FontSize="12" FontStyle="Italic"
                       HorizontalAlignment="Center"
                       Margin="0,15,0,0"
                       Foreground="DarkOrange"/>
        </StackPanel>
    </Border>
</Window>